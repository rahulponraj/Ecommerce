<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/admin-orders.css">
    <style>
        .filter-form-container {
            margin: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        label {
            font-weight: bold;
        }


        input[type="date"] {
            border: 1px solid #ccc;
            border-radius: 4px;
        }
    </style>


</head>

<body>
    <div class="admin-panel">
        <div class="sidebar">
            <div class="sidebar-header">
                <a class="admin-logo" href="/admin">Admin Panel</a>
            </div>
            <ul class="sidebar-menu">
                <li class="menu-item ">
                    <a href="/admin/dashboard">Dashboard</a>
                </li>
                <li class="menu-item">
                    <a href="/admin/listProducts">Products</a>
                </li>
                <li class="menu-item">
                    <a href="/admin/categories">Categories</a>
                </li>
                <li class="menu-item active">
                    <a href="/admin/orders ">Orders</a>
                </li>
                <li class="menu-item">
                    <a href="/admin/coupons">Coupons</a>
                </li>
                <li class="menu-item">
                    <a href="/admin/listUsers ">Customers</a>
                </li>
                <li class="menu-item">
                    <a href="/admin/banners">Banners</a>
                </li>
            </ul>
        </div>
        <div class="content">
            <div class="container">
                <div class="navbar">
                    <form action="/admin/vieworders" method="get">
                        <label for="startDate">Start Date:</label>
                        <input type="date" id="startDate" name="startDate">
                        <label for="endDate">End Date:</label>
                        <input type="date" id="endDate" name="endDate">
                        <button type="submit" class="btn btn-dark"> Apply </button>
                    </form>
                    <form action="/admin/downloadexcelreport" method="get">
                        <button type="submit" class="btn btn-outline-success">Download Excel Report</button>
                    </form>
                    <form action="/admin/downloadpdfreport" method="get">
                        <button type="submit" class="btn btn-outline-success">Download PDF Report</button>
                    </form>
                    <a style="color:white" href="/admin/logout">
                        <button class="add-category-btn">logout</button>
                    </a>

                </div>
            </div>
            <main>
                <div class="container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Order ID</th>
                                <th>No of Items</th>
                                <th>Order value</th>
                                <th>Status</th>
                                <th>Update Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (typeof orders !=='undefined' && orders.length> 0) {
                                for (let i = 0; i < orders.length; i++) { %>
                                    <tr>
                                        <td>
                                            <%= [i+1] %>
                                        </td>
                                        <td><a href="/admin/orders/orderView?orderId=<%= orders[i].orderId %>">
                                                <%= orders[i].orderId %>
                                            </a></td>
                                        <td>
                                            <%= orders[i].cart.length %>
                                        </td>
                                        <td>
                                            <%= orders[i].totalSalePrice %>
                                        </td>
                                        <td>
                                            <%= orders[i].status %>
                                        </td>
                                        <% if(orders[i].status=="Cancelled" ){%>
                                            <td>Order Cancelled</td>
                                            <%} else { %>
                                                <td>
                                                    <form method="post" action="/admin/orders/editOrderStatus">
                                                        <input type="hidden" name="orderId"
                                                            value="<%= orders[i].orderId %>">


                                                        <select class="selectStatus" name="orderStatus"
                                                            id="orderStatus">
                                                            <% const orderStatuses=["Pending","Confirmed", "Processing"
                                                                ,"Packed", "Shipped" ,"Out for Delivery", "Delivered"
                                                                ,"Cancelled"]; %>
                                                                <% for (let status of orderStatuses) { %>
                                                                    <option value="<%= status %>" <% if
                                                                        (status===orders[i].status) { %>selected<% } %>>
                                                                            <%= status %>
                                                                    </option>
                                                                    <% } %>
                                                        </select>

                                                        <button type="submit" class="order-btn-edit">UPDATE</button>

                                                    </form>

                                                </td>

                                                <%}%>
                                                    <td><a
                                                            href="/admin/orders/orderView?orderId=<%= orders[i].orderId %>">view
                                                            order -></a></td>
                                    </tr>
                                    <% } } else { %>
                                        <tr>
                                            <td colspan="4">Users not found</td>
                                        </tr>
                                        <% } %>
                        </tbody>
                    </table>
                </div>
            </main>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>